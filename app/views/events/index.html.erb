<div class="event-index">
  <%- model_class = Event -%>
  <div class="page-header">
    <h1><%=t '.title', :default => model_class.model_name.human.pluralize.titleize %></h1>
  </div>

  <% if params[:carpool] == "false" %>
    <div class="table-container">
      <table class="table">
        <thead>
          <th><%= model_class.human_attribute_name(:description) %></th>
          <th><%= model_class.human_attribute_name(:time) %></th>
          <th><%=t '.actions', :default => t("helpers.actions") %></th>
        </thead>
        <tbody>
          <% @events.each do |event| %>
            <tr onclick="location.href='<%= event_path(current_user.id,event.id,{ carpool: 'false'}) %>'">
              <td><%= event.description %></td>
              <td><%= event.time.strftime("%I:%M%p").downcase %></td>
              <td>
                  <%= link_to 'Join', user_messages_path(current_user.id, event.id,{carpool: "false"}), class: 'btn btn-default btn-xs'  %>
                  <% if (current_user.id == event.concert.user_id) %>
                    <%= link_to t('.edit', :default => t("helpers.links.edit")),
                                edit_event_path(event), :class => 'btn btn-default btn-xs' %>
                  <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <button type="button" class="btn btn-md btn-primary" id="myBtn">New Meetup2</button>

    <div id="user-modal" class="modal fade"></div>
    <!-- Modal -->
    <div class="modal fade" id="myModal" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">

          <%= form_for ([@user, @event]), html: { class: "form-horizontal event" } do |f| %>
            <div class="form-group">
              <%= f.label :time, :class => 'control-label col-md-1' %>
              <div class="col-md-10">
                <%= f.time_select :time, {ampm: true, minute_step: 15} %>
              </div>
              <%=f.error_span(:time) %>
            </div>
            <div class="form-group">
              <%= f.label :location, :class => 'control-label col-lg-2' %>
              <div class="col-lg-10">
                <%= f.text_field :location, :class => 'form-control' %>
              </div>
              <%=f.error_span(:location) %>
            </div>
            <div class="form-group">
              <%= f.label :description, :class => 'control-label col-lg-2'%>
              <div class="col-lg-10">
                <%= f.text_area :description, :class => 'form-control', rows: 10 %>
                <%= f.text_field :carpool, value: "false" %>
                <%= f.text_field :concert_id, value: params[:format] %>
              </div>
              <%=f.error_span(:description) %>
            </div>
            <div class="form-group">
              <div class="col-lg-offset-2 col-lg-10">
                <%= f.submit 'Submit', :class => 'btn btn-primary' %>
                <button type="button" class="btn btn-md btn-primary" data-dismiss="modal">Cancel</button>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  <% else %>
    <%= render 'map' %>
    <%= render '/messages/index' %>

  <footer class="fixed_footer">
    <p>&copy; AmpedUp 2016</p>
  </footer>
  <footer class="footer">
    <p>&copy; AmpedUp 2016</p>
  </footer>

  <% end %>


</div>



<script>
$(document).ready(function(){
  console.log("hi")
  $("#confirm_button").hide();

  $("#submit").click(function() {
    $("#confirm_button").show();
    $("#submit").hide();
  });

  $(".removeOnFocus").each(function(){
    this.data = new Object(); //TODO don't overwrite previous data
    this.data.value = this.value;

    $(this).focus(function(){
      if (this.value == this.data.value)
      this.value = '';
    });
    $(this).blur(function(){
      if (this.value == '')
      this.value = this.data.value;
    });
  });
});
</script>
