<div class="event-index">
<%- model_class = Event -%>

<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human.pluralize.titleize %></h1>
</div>

<% if params[:carpool] == "false" %>
  <div class="table-container meetup-container">
  <table class="table">
    <thead>
            <th><%= model_class.human_attribute_name(:description) %></th>
            <th><%= model_class.human_attribute_name(:time) %></th>
            <th><%=t '.actions', :default => t("helpers.actions") %></th>
    </thead>
    <tbody>
      <% @events.each do |event| %>
        <tr onclick="location.href='<%= event_path(params[:user_id],event.id,{"carpool"=>"false"}) %>'">
          <td><%= event.description %></td>
          <td><%= event.time.strftime("%I:%M%p").downcase %></td>
          <td>
              <%= link_to 'Join', user_messages_path(event, params[:user_id]), class: 'btn btn-default btn-xs'  %>
              <% if (current_user.id == event.concert.user_id) %>
                <%= link_to t('.edit', :default => t("helpers.links.edit")),
                            edit_event_path(event), :class => 'btn btn-default btn-xs' %>
                <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                          event_path(event),
                          :method => :delete,
                          :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                          :class => 'btn btn-xs btn-danger' %>
              <% end %>
            </td>
          </tr>

      <!-- <tr onclick="location.href='<%= event_path(params[:user_id],event,{"carpool"=>"false"}) %>'">
        <td><%#= event.description %></td>
        <td><%#= event.location %></td>
        <% if event.time %>
        <td><%#= event.time.strftime("%I:%M%p").downcase %></td>
        <% else %>
        <td><%= event.time %></td>
        <% end %>
        <td><%= event.concert_id %></td>
        <td>
          <%#= link_to 'Join', user_messages_path(event, params[:user_id]), class: 'btn btn-default btn-xs'  %>
          <%= link_to t('.edit', :default => t("helpers.links.edit")),
          edit_event_path(event), :class => 'btn btn-default btn-xs' %>
          <%#= link_to t('.destroy', :default => t("helpers.links.destroy")),
          event_path(event),
          :method => :delete,
          :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
          :class => 'btn btn-xs btn-danger' %>
        </td>
      </tr> -->
      <% end %>
    </tbody>
  </table>
  <%= link_to 'New Meetup', new_user_event_path(params[:user_id]), class: 'btn btn-primary' %>

  <button type="button" class="btn btn-md btn-primary" id="myBtn">New Meetup2</button>
</div>
</div>


  <div id="user-modal" class="modal fade"></div>
  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <button type="button" class="close" data-dismiss="modal">&times;</button>

        <%= form_for @event, url: {controller:'messages', action:'create'}, html: { multipart: true, class:"form-horizontal user" } do |f| %>

          <div class="form-group">
            <%= f.label "Location:", :class => 'control-label col-lg-2' %>
              <%= f.text_field :location, class: 'form-control'%>
              <br>
              <%= f.text_area :description, class: 'form-control', rows: 10 %>
              <%= f.text_field :user_id, value: current_user.id %>
              <%= f.text_field :event_id, value: params[:format] %>
          </div>

          <div class="form-group">
            <div class="col-lg-offset-2 col-lg-10">
              <%= f.submit "Post", :class => 'btn btn-primary modal-close'%>
            </div>
          </div>
        <% end %>
      </div>

    </div>
  </div>


<% else %>
  <%= render 'map' %>
  <%= render '/messages/index' %>
<% end %>


  <script>
  $(document).ready(function(){
    console.log("hi")
    $("#confirm_button").hide();

    $("#submit").click(function() {
      $("#confirm_button").show();
      $("#submit").hide();
    });

    $(".removeOnFocus").each(function(){
      this.data = new Object(); //TODO don't overwrite previous data
      this.data.value = this.value;

      $(this).focus(function(){
        if (this.value == this.data.value)
        this.value = '';
      });
      $(this).blur(function(){
        if (this.value == '')
        this.value = this.data.value;
      });
    });
  });
  </script>
